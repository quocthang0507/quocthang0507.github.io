document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("input-text"),t=document.getElementById("file-input"),n=document.getElementById("generate-btn"),a=document.getElementById("paste-input-btn"),s=document.getElementById("clear-input-btn"),i=document.getElementById("clear-file-btn"),o=document.getElementById("input-char-count"),d=document.getElementById("input-byte-count"),r=document.getElementById("alert-container"),c=document.getElementById("hash-results"),l=document.getElementById("copy-all-btn"),u=document.getElementById("file-hash-progress"),h=document.getElementById("progress-bar"),m=document.getElementById("progress-text"),g=document.getElementById("file-size-info"),f=document.getElementById("file-info-display"),y=document.getElementById("file-name"),p=document.getElementById("file-size"),I=document.getElementById("file-type"),H=document.getElementById("processing-time"),F={md5:document.getElementById("md5-hash"),sha1:document.getElementById("sha1-hash"),sha256:document.getElementById("sha256-hash"),sha384:document.getElementById("sha384-hash"),sha512:document.getElementById("sha512-hash")};let E=null,w="",G=0,v="";function b(){t.value="",E=null,w="",G=0,v="",u.style.display="none",f.style.display="none",e.placeholder=S("hash.input_placeholder")||"Enter text to hash..."}async function B(e,t,n){return await new Promise(n=>{setTimeout(async()=>{const a=await A(e,t);n(a)},0)})}async function L(e){return function(e){const t={rotateLeft:function(e,t){return e<<t|e>>>32-t},addUnsigned:function(e,t){const n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n},F:function(e,t,n){return e&t|~e&n},G:function(e,t,n){return e&n|t&~n},H:function(e,t,n){return e^t^n},I:function(e,t,n){return t^(e|~n)},FF:function(e,t,n,a,s,i,o){return e=this.addUnsigned(e,this.addUnsigned(this.addUnsigned(this.F(t,n,a),s),o)),this.addUnsigned(this.rotateLeft(e,i),t)},GG:function(e,t,n,a,s,i,o){return e=this.addUnsigned(e,this.addUnsigned(this.addUnsigned(this.G(t,n,a),s),o)),this.addUnsigned(this.rotateLeft(e,i),t)},HH:function(e,t,n,a,s,i,o){return e=this.addUnsigned(e,this.addUnsigned(this.addUnsigned(this.H(t,n,a),s),o)),this.addUnsigned(this.rotateLeft(e,i),t)},II:function(e,t,n,a,s,i,o){return e=this.addUnsigned(e,this.addUnsigned(this.addUnsigned(this.I(t,n,a),s),o)),this.addUnsigned(this.rotateLeft(e,i),t)}},n=e.length,a=[];for(let t=0;t<n;t++)a[t>>2]|=e[t]<<t%4*8;const s=8*n;a[n>>2]|=128<<n%4*8,a[16*(n+8>>6)+14]=s;let i=1732584193,o=4023233417,d=2562383102,r=271733878;for(let e=0;e<a.length;e+=16){const n=i,s=o,c=d,l=r;i=t.FF(i,o,d,r,a[e+0],7,3614090360),r=t.FF(r,i,o,d,a[e+1],12,3905402710),d=t.FF(d,r,i,o,a[e+2],17,606105819),o=t.FF(o,d,r,i,a[e+3],22,3250441966),i=t.FF(i,o,d,r,a[e+4],7,4118548399),r=t.FF(r,i,o,d,a[e+5],12,1200080426),d=t.FF(d,r,i,o,a[e+6],17,2821735955),o=t.FF(o,d,r,i,a[e+7],22,4249261313),i=t.FF(i,o,d,r,a[e+8],7,1770035416),r=t.FF(r,i,o,d,a[e+9],12,2336552879),d=t.FF(d,r,i,o,a[e+10],17,4294925233),o=t.FF(o,d,r,i,a[e+11],22,2304563134),i=t.FF(i,o,d,r,a[e+12],7,1804603682),r=t.FF(r,i,o,d,a[e+13],12,4254626195),d=t.FF(d,r,i,o,a[e+14],17,2792965006),o=t.FF(o,d,r,i,a[e+15],22,1236535329),i=t.GG(i,o,d,r,a[e+1],5,4129170786),r=t.GG(r,i,o,d,a[e+6],9,3225465664),d=t.GG(d,r,i,o,a[e+11],14,643717713),o=t.GG(o,d,r,i,a[e+0],20,3921069994),i=t.GG(i,o,d,r,a[e+5],5,3593408605),r=t.GG(r,i,o,d,a[e+10],9,38016083),d=t.GG(d,r,i,o,a[e+15],14,3634488961),o=t.GG(o,d,r,i,a[e+4],20,3889429448),i=t.GG(i,o,d,r,a[e+9],5,568446438),r=t.GG(r,i,o,d,a[e+14],9,3275163606),d=t.GG(d,r,i,o,a[e+3],14,4107603335),o=t.GG(o,d,r,i,a[e+8],20,1163531501),i=t.GG(i,o,d,r,a[e+13],5,2850285829),r=t.GG(r,i,o,d,a[e+2],9,4243563512),d=t.GG(d,r,i,o,a[e+7],14,1735328473),o=t.GG(o,d,r,i,a[e+12],20,2368359562),i=t.HH(i,o,d,r,a[e+5],4,4294588738),r=t.HH(r,i,o,d,a[e+8],11,2272392833),d=t.HH(d,r,i,o,a[e+11],16,1839030562),o=t.HH(o,d,r,i,a[e+14],23,4259657740),i=t.HH(i,o,d,r,a[e+1],4,2763975236),r=t.HH(r,i,o,d,a[e+4],11,1272893353),d=t.HH(d,r,i,o,a[e+7],16,4139469664),o=t.HH(o,d,r,i,a[e+10],23,3200236656),i=t.HH(i,o,d,r,a[e+13],4,681279174),r=t.HH(r,i,o,d,a[e+0],11,3936430074),d=t.HH(d,r,i,o,a[e+3],16,3572445317),o=t.HH(o,d,r,i,a[e+6],23,76029189),i=t.HH(i,o,d,r,a[e+9],4,3654602809),r=t.HH(r,i,o,d,a[e+12],11,3873151461),d=t.HH(d,r,i,o,a[e+15],16,530742520),o=t.HH(o,d,r,i,a[e+2],23,3299628645),i=t.II(i,o,d,r,a[e+0],6,4096336452),r=t.II(r,i,o,d,a[e+7],10,1126891415),d=t.II(d,r,i,o,a[e+14],15,2878612391),o=t.II(o,d,r,i,a[e+5],21,4237533241),i=t.II(i,o,d,r,a[e+12],6,1700485571),r=t.II(r,i,o,d,a[e+3],10,2399980690),d=t.II(d,r,i,o,a[e+10],15,4293915773),o=t.II(o,d,r,i,a[e+1],21,2240044497),i=t.II(i,o,d,r,a[e+8],6,1873313359),r=t.II(r,i,o,d,a[e+15],10,4264355552),d=t.II(d,r,i,o,a[e+6],15,2734768916),o=t.II(o,d,r,i,a[e+13],21,1309151649),i=t.II(i,o,d,r,a[e+4],6,4149444226),r=t.II(r,i,o,d,a[e+11],10,3174756917),d=t.II(d,r,i,o,a[e+2],15,718787259),o=t.II(o,d,r,i,a[e+9],21,3951481745),i=t.addUnsigned(i,n),o=t.addUnsigned(o,s),d=t.addUnsigned(d,c),r=t.addUnsigned(r,l)}return U(i)+U(o)+U(d)+U(r)}(e)}function U(e){let t="";for(let n=0;n<=3;n++){t+=(e>>>8*n&255).toString(16).padStart(2,"0")}return t}async function A(e,t){const n=await crypto.subtle.digest(e,t);return Array.from(new Uint8Array(n)).map(e=>e.toString(16).padStart(2,"0")).join("")}function M(){const t=e.value;o.textContent=t.length,d.textContent=new Blob([t]).size}function T(e){if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+["Bytes","KB","MB"][t]}function x(e,t){const n=document.createElement("div");n.className=`alert alert-${t} alert-dismissible fade show`,n.innerHTML=`\n            ${e}\n            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>\n        `,r.innerHTML="",r.appendChild(n),setTimeout(()=>{n.remove()},5e3)}function S(e){return void 0!==window.translations&&window.translations[e]?window.translations[e]:null}M(),e.addEventListener("input",function(){M(),E=null,t.value=""}),t.addEventListener("change",function(n){const a=n.target.files[0];if(!a)return;if(a.size>104857600)return x("File size exceeds 100MB limit","danger"),void(t.value="");w=a.name,G=a.size,v=a.type||"application/octet-stream";const s=new FileReader;s.onload=function(t){E=t.target.result,e.value="",e.placeholder=`File loaded: ${w} (${T(a.size)})`,M()},s.readAsArrayBuffer(a)}),i.addEventListener("click",b),n.addEventListener("click",async function(){try{const t=performance.now();let a,s,i=!1;if(E)a=new Uint8Array(E),i=G>5242880,i&&(u.style.display="block",g.textContent=`${T(G)}`);else{const t=e.value.trim();if(!t)throw new Error("Please enter text or select a file to hash");a=(new TextEncoder).encode(t)}if(n.disabled=!0,n.innerHTML='<span class="spinner-border spinner-border-sm me-2"></span>Generating...',s=i?await async function(e){const t=1048576,n=5;let a=0;const s=()=>{const e=Math.round(a/n*100);h.style.width=e+"%",h.textContent=e+"%",m.textContent=e+"%",h.setAttribute("aria-valuenow",e)},i=await async function(e,t,n){n&&n();return await new Promise(t=>{setTimeout(()=>{t(L(e))},0)})}(e,0,()=>{a=.2,s()});a=1,s();const o=await B("SHA-1",e,t);a=2,s();const d=await B("SHA-256",e,t);a=3,s();const r=await B("SHA-384",e,t);a=4,s();const c=await B("SHA-512",e,t);return a=5,s(),[i,o,d,r,c]}(a):await Promise.all([L(a),A("SHA-1",a),A("SHA-256",a),A("SHA-384",a),A("SHA-512",a)]),F.md5.value=s[0],F.sha1.value=s[1],F.sha256.value=s[2],F.sha384.value=s[3],F.sha512.value=s[4],c.style.display="block",E){const e=((performance.now()-t)/1e3).toFixed(2);y.textContent=w,p.textContent=T(G),I.textContent=v,H.textContent=`${e}s`,f.style.display="block"}else f.style.display="none";x("Hashes generated successfully!","success"),c.scrollIntoView({behavior:"smooth",block:"nearest"})}catch(e){x(`Error: ${e.message}`,"danger")}finally{n.disabled=!1,n.innerHTML='<i class="fas fa-fingerprint"></i> '+(S("hash.generate")||"Generate Hashes"),setTimeout(()=>{u.style.display="none"},1e3)}}),a.addEventListener("click",async function(){try{const t=await navigator.clipboard.readText();e.value=t,b(),M(),x("Pasted from clipboard!","success")}catch(e){x("Failed to read clipboard","danger")}}),s.addEventListener("click",function(){e.value="",b(),M(),c.style.display="none"}),l.addEventListener("click",async function(){const e=`MD5: ${F.md5.value}\nSHA-1: ${F.sha1.value}\nSHA-256: ${F.sha256.value}\nSHA-384: ${F.sha384.value}\nSHA-512: ${F.sha512.value}`;try{await navigator.clipboard.writeText(e),x("All hashes copied to clipboard!","success");const t=l.innerHTML;l.innerHTML='<i class="fas fa-check"></i> '+(S("hash.copied")||"Copied!"),setTimeout(()=>{l.innerHTML=t},2e3)}catch(e){x("Failed to copy to clipboard","danger")}}),document.querySelectorAll(".copy-hash-btn").forEach(e=>{e.addEventListener("click",function(){!async function(e,t){const n=document.getElementById(e);try{await navigator.clipboard.writeText(n.value),x("Hash copied to clipboard!","success");const e=t.innerHTML;t.innerHTML='<i class="fas fa-check"></i> '+(S("hash.copied")||"Copied!"),setTimeout(()=>{t.innerHTML=e},2e3)}catch(e){x("Failed to copy to clipboard","danger")}}(this.getAttribute("data-target"),this)})})});