document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("input-text"),t=document.getElementById("file-input"),n=document.getElementById("generate-btn"),s=document.getElementById("paste-input-btn"),a=document.getElementById("clear-input-btn"),i=document.getElementById("clear-file-btn"),d=document.getElementById("input-char-count"),o=document.getElementById("input-byte-count"),c=document.getElementById("alert-container"),l=document.getElementById("hash-results"),r=document.getElementById("copy-all-btn"),u=document.getElementById("file-hash-progress"),h=(document.getElementById("progress-bar"),document.getElementById("progress-text"),document.getElementById("file-size-info")),m=document.getElementById("file-info-display"),g=document.getElementById("file-name"),y=document.getElementById("file-size"),f=document.getElementById("file-type"),p=document.getElementById("processing-time"),I=document.getElementById("select-all-algorithms"),H={md5:document.getElementById("md5-hash"),sha1:document.getElementById("sha1-hash"),sha256:document.getElementById("sha256-hash"),sha384:document.getElementById("sha384-hash"),sha512:document.getElementById("sha512-hash")},E={md5:document.getElementById("check-md5"),sha1:document.getElementById("check-sha1"),sha256:document.getElementById("check-sha256"),sha384:document.getElementById("check-sha384"),sha512:document.getElementById("check-sha512")};let F=null,b="",v=0,B="";function G(){const e=[];return Object.entries(E).forEach(([t,n])=>{n&&n.checked&&e.push(t)}),e}function w(){t.value="",F=null,b="",v=0,B="",u.style.display="none",m.style.display="none",e.placeholder=T("hash.input_placeholder")||"Enter text to hash..."}async function L(e){return function(e){const t={rotateLeft:function(e,t){return e<<t|e>>>32-t},addUnsigned:function(e,t){const n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n},F:function(e,t,n){return e&t|~e&n},G:function(e,t,n){return e&n|t&~n},H:function(e,t,n){return e^t^n},I:function(e,t,n){return t^(e|~n)},FF:function(e,t,n,s,a,i,d){return e=this.addUnsigned(e,this.addUnsigned(this.addUnsigned(this.F(t,n,s),a),d)),this.addUnsigned(this.rotateLeft(e,i),t)},GG:function(e,t,n,s,a,i,d){return e=this.addUnsigned(e,this.addUnsigned(this.addUnsigned(this.G(t,n,s),a),d)),this.addUnsigned(this.rotateLeft(e,i),t)},HH:function(e,t,n,s,a,i,d){return e=this.addUnsigned(e,this.addUnsigned(this.addUnsigned(this.H(t,n,s),a),d)),this.addUnsigned(this.rotateLeft(e,i),t)},II:function(e,t,n,s,a,i,d){return e=this.addUnsigned(e,this.addUnsigned(this.addUnsigned(this.I(t,n,s),a),d)),this.addUnsigned(this.rotateLeft(e,i),t)}},n=e.length,s=[];for(let t=0;t<n;t++)s[t>>2]|=e[t]<<t%4*8;const a=8*n;s[n>>2]|=128<<n%4*8,s[16*(n+8>>6)+14]=a;let i=1732584193,d=4023233417,o=2562383102,c=271733878;for(let e=0;e<s.length;e+=16){const n=i,a=d,l=o,r=c;i=t.FF(i,d,o,c,s[e+0],7,3614090360),c=t.FF(c,i,d,o,s[e+1],12,3905402710),o=t.FF(o,c,i,d,s[e+2],17,606105819),d=t.FF(d,o,c,i,s[e+3],22,3250441966),i=t.FF(i,d,o,c,s[e+4],7,4118548399),c=t.FF(c,i,d,o,s[e+5],12,1200080426),o=t.FF(o,c,i,d,s[e+6],17,2821735955),d=t.FF(d,o,c,i,s[e+7],22,4249261313),i=t.FF(i,d,o,c,s[e+8],7,1770035416),c=t.FF(c,i,d,o,s[e+9],12,2336552879),o=t.FF(o,c,i,d,s[e+10],17,4294925233),d=t.FF(d,o,c,i,s[e+11],22,2304563134),i=t.FF(i,d,o,c,s[e+12],7,1804603682),c=t.FF(c,i,d,o,s[e+13],12,4254626195),o=t.FF(o,c,i,d,s[e+14],17,2792965006),d=t.FF(d,o,c,i,s[e+15],22,1236535329),i=t.GG(i,d,o,c,s[e+1],5,4129170786),c=t.GG(c,i,d,o,s[e+6],9,3225465664),o=t.GG(o,c,i,d,s[e+11],14,643717713),d=t.GG(d,o,c,i,s[e+0],20,3921069994),i=t.GG(i,d,o,c,s[e+5],5,3593408605),c=t.GG(c,i,d,o,s[e+10],9,38016083),o=t.GG(o,c,i,d,s[e+15],14,3634488961),d=t.GG(d,o,c,i,s[e+4],20,3889429448),i=t.GG(i,d,o,c,s[e+9],5,568446438),c=t.GG(c,i,d,o,s[e+14],9,3275163606),o=t.GG(o,c,i,d,s[e+3],14,4107603335),d=t.GG(d,o,c,i,s[e+8],20,1163531501),i=t.GG(i,d,o,c,s[e+13],5,2850285829),c=t.GG(c,i,d,o,s[e+2],9,4243563512),o=t.GG(o,c,i,d,s[e+7],14,1735328473),d=t.GG(d,o,c,i,s[e+12],20,2368359562),i=t.HH(i,d,o,c,s[e+5],4,4294588738),c=t.HH(c,i,d,o,s[e+8],11,2272392833),o=t.HH(o,c,i,d,s[e+11],16,1839030562),d=t.HH(d,o,c,i,s[e+14],23,4259657740),i=t.HH(i,d,o,c,s[e+1],4,2763975236),c=t.HH(c,i,d,o,s[e+4],11,1272893353),o=t.HH(o,c,i,d,s[e+7],16,4139469664),d=t.HH(d,o,c,i,s[e+10],23,3200236656),i=t.HH(i,d,o,c,s[e+13],4,681279174),c=t.HH(c,i,d,o,s[e+0],11,3936430074),o=t.HH(o,c,i,d,s[e+3],16,3572445317),d=t.HH(d,o,c,i,s[e+6],23,76029189),i=t.HH(i,d,o,c,s[e+9],4,3654602809),c=t.HH(c,i,d,o,s[e+12],11,3873151461),o=t.HH(o,c,i,d,s[e+15],16,530742520),d=t.HH(d,o,c,i,s[e+2],23,3299628645),i=t.II(i,d,o,c,s[e+0],6,4096336452),c=t.II(c,i,d,o,s[e+7],10,1126891415),o=t.II(o,c,i,d,s[e+14],15,2878612391),d=t.II(d,o,c,i,s[e+5],21,4237533241),i=t.II(i,d,o,c,s[e+12],6,1700485571),c=t.II(c,i,d,o,s[e+3],10,2399980690),o=t.II(o,c,i,d,s[e+10],15,4293915773),d=t.II(d,o,c,i,s[e+1],21,2240044497),i=t.II(i,d,o,c,s[e+8],6,1873313359),c=t.II(c,i,d,o,s[e+15],10,4264355552),o=t.II(o,c,i,d,s[e+6],15,2734768916),d=t.II(d,o,c,i,s[e+13],21,1309151649),i=t.II(i,d,o,c,s[e+4],6,4149444226),c=t.II(c,i,d,o,s[e+11],10,3174756917),o=t.II(o,c,i,d,s[e+2],15,718787259),d=t.II(d,o,c,i,s[e+9],21,3951481745),i=t.addUnsigned(i,n),d=t.addUnsigned(d,a),o=t.addUnsigned(o,l),c=t.addUnsigned(c,r)}return k(i)+k(d)+k(o)+k(c)}(e)}function k(e){let t="";for(let n=0;n<=3;n++){t+=(e>>>8*n&255).toString(16).padStart(2,"0")}return t}async function U(e,t){const n=await crypto.subtle.digest(e,t);return Array.from(new Uint8Array(n)).map(e=>e.toString(16).padStart(2,"0")).join("")}function A(){const t=e.value;d.textContent=t.length,o.textContent=new Blob([t]).size}function M(e){if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+["Bytes","KB","MB"][t]}function x(e,t){const n=document.createElement("div");n.className=`alert alert-${t} alert-dismissible fade show`,n.innerHTML=`\n            ${e}\n            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>\n        `,c.innerHTML="",c.appendChild(n),setTimeout(()=>{n.remove()},5e3)}function T(e){return void 0!==window.translations&&window.translations[e]?window.translations[e]:null}A(),e.addEventListener("input",function(){A(),F=null,t.value=""}),t.addEventListener("change",function(n){const s=n.target.files[0];if(!s)return;if(s.size>104857600)return x("File size exceeds 100MB limit","danger"),void(t.value="");b=s.name,v=s.size,B=s.type||"application/octet-stream";const a=new FileReader;a.onload=function(t){F=t.target.result,e.value="",e.placeholder=`File loaded: ${b} (${M(s.size)})`,A()},a.readAsArrayBuffer(s)}),i.addEventListener("click",w),n.addEventListener("click",async function(){try{const t=performance.now();let s,a=!1;const i=G();if(0===i.length)throw new Error(T("hash.error_no_algorithm")||"Please select at least one hash algorithm");if(F)s=new Uint8Array(F),a=v>5242880,a&&(u.style.display="block",h.textContent=`${M(v)}`);else{const t=e.value.trim();if(!t)throw new Error("Please enter text or select a file to hash");s=(new TextEncoder).encode(t)}n.disabled=!0,n.innerHTML='<span class="spinner-border spinner-border-sm me-2"></span>Generating...',Object.values(H).forEach(e=>{e&&(e.value="")});const d=[],o=[];i.includes("md5")&&(d.push(L(s)),o.push("md5")),i.includes("sha1")&&(d.push(U("SHA-1",s)),o.push("sha1")),i.includes("sha256")&&(d.push(U("SHA-256",s)),o.push("sha256")),i.includes("sha384")&&(d.push(U("SHA-384",s)),o.push("sha384")),i.includes("sha512")&&(d.push(U("SHA-512",s)),o.push("sha512"));const c=await Promise.all(d);if(o.forEach((e,t)=>{H[e]&&(H[e].value=c[t],H[e].closest(".mb-3").style.display="block")}),Object.entries(H).forEach(([e,t])=>{t&&!i.includes(e)&&(t.closest(".mb-3").style.display="none")}),l.style.display="block",F){const e=((performance.now()-t)/1e3).toFixed(2);g.textContent=b,y.textContent=M(v),f.textContent=B,p.textContent=`${e}s`,m.style.display="block"}else m.style.display="none";x("Hashes generated successfully!","success"),l.scrollIntoView({behavior:"smooth",block:"nearest"})}catch(e){x(`Error: ${e.message}`,"danger")}finally{n.disabled=!1,n.innerHTML='<i class="fas fa-fingerprint"></i> '+(T("hash.generate")||"Generate Hashes"),setTimeout(()=>{u.style.display="none"},1e3)}}),s.addEventListener("click",async function(){try{const t=await navigator.clipboard.readText();e.value=t,w(),A(),x("Pasted from clipboard!","success")}catch(e){x("Failed to read clipboard","danger")}}),a.addEventListener("click",function(){e.value="",w(),A(),l.style.display="none"}),r.addEventListener("click",async function(){const e=G(),t=[];e.includes("md5")&&H.md5.value&&t.push(`MD5: ${H.md5.value}`);e.includes("sha1")&&H.sha1.value&&t.push(`SHA-1: ${H.sha1.value}`);e.includes("sha256")&&H.sha256.value&&t.push(`SHA-256: ${H.sha256.value}`);e.includes("sha384")&&H.sha384.value&&t.push(`SHA-384: ${H.sha384.value}`);e.includes("sha512")&&H.sha512.value&&t.push(`SHA-512: ${H.sha512.value}`);const n=t.join("\n");try{await navigator.clipboard.writeText(n),x("All hashes copied to clipboard!","success");const e=r.innerHTML;r.innerHTML='<i class="fas fa-check"></i> '+(T("hash.copied")||"Copied!"),setTimeout(()=>{r.innerHTML=e},2e3)}catch(e){x("Failed to copy to clipboard","danger")}}),I&&I.addEventListener("click",function(){const e=document.querySelectorAll(".hash-algorithm-check"),t=Array.from(e).every(e=>e.checked);e.forEach(e=>e.checked=!t),this.textContent=t?T("hash.select_all")||"Select All":T("hash.deselect_all")||"Deselect All"}),document.querySelectorAll(".copy-hash-btn").forEach(e=>{e.addEventListener("click",function(){!async function(e,t){const n=document.getElementById(e);try{await navigator.clipboard.writeText(n.value),x("Hash copied to clipboard!","success");const e=t.innerHTML;t.innerHTML='<i class="fas fa-check"></i> '+(T("hash.copied")||"Copied!"),setTimeout(()=>{t.innerHTML=e},2e3)}catch(e){x("Failed to copy to clipboard","danger")}}(this.getAttribute("data-target"),this)})})});