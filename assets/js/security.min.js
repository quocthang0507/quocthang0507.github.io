function escapeHtml(e){if(!e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}function sanitizeHtml(e){if(!e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}function safeSetInnerHTML(e,t){e&&(/<[^>]+>/.test(t)?e.innerHTML=sanitizeHtml(t):e.textContent=t)}function sanitizeUrl(e){if(!e)return null;const t=e.trim().toLowerCase();return t.startsWith("javascript:")||t.startsWith("data:")||t.startsWith("vbscript:")?(console.warn("Blocked potentially dangerous URL:",e),null):e}function sanitizeError(e){if(!e)return"An unknown error occurred";return escapeHtml(e.message||e.toString())}function showSafeAlert(e,t,n){if(!n)return;const r=document.createElement("div");r.className=`alert alert-${t} alert-dismissible fade show`;const i=document.createElement("span");i.textContent=e;const s=document.createElement("button");s.type="button",s.className="btn-close",s.setAttribute("data-bs-dismiss","alert"),s.setAttribute("aria-label","Close"),r.appendChild(i),r.appendChild(s),n.innerHTML="",n.appendChild(r),setTimeout(()=>{r.remove()},5e3)}function isInputSafe(e){if(!e)return!0;return![/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,/javascript:/gi,/on\w+\s*=/gi,/<iframe/gi,/<object/gi,/<embed/gi].some(t=>t.test(e))}"undefined"!=typeof module&&module.exports&&(module.exports={escapeHtml:escapeHtml,sanitizeHtml:sanitizeHtml,safeSetInnerHTML:safeSetInnerHTML,sanitizeUrl:sanitizeUrl,sanitizeError:sanitizeError,showSafeAlert:showSafeAlert,isInputSafe:isInputSafe});