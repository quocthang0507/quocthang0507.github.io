function escapeHtml(e){if(!e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}function sanitizeHtml(e){if(!e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}function safeSetInnerHTML(e,t){e&&(/<[^>]+>/.test(t)?e.innerHTML=sanitizeHtml(t):e.textContent=t)}function sanitizeUrl(e){if(!e)return null;const t=e.trim().toLowerCase();return t.startsWith("javascript:")||t.startsWith("data:")||t.startsWith("vbscript:")?(console.warn("Blocked potentially dangerous URL:",e),null):e}function sanitizeError(e){if(!e)return"An unknown error occurred";return escapeHtml(e.message||e.toString())}function showSafeAlert(e,t,n){if(!n)return;const r=document.createElement("div");r.className=`alert alert-${t} alert-dismissible fade show`;const s=document.createElement("span");s.textContent=e;const i=document.createElement("button");i.type="button",i.className="btn-close",i.setAttribute("data-bs-dismiss","alert"),i.setAttribute("aria-label","Close"),r.appendChild(s),r.appendChild(i),n.innerHTML="",n.appendChild(r),setTimeout(()=>{r.remove()},5e3)}function isInputSafe(e){if(!e)return!0;const t=e.toLowerCase().replace(/\s+/g," ");return!["<script","javascript:","onerror=","onload=","onclick=","<iframe","<object","<embed","eval(","expression("].some(e=>t.includes(e))}"undefined"!=typeof module&&module.exports&&(module.exports={escapeHtml:escapeHtml,sanitizeHtml:sanitizeHtml,safeSetInnerHTML:safeSetInnerHTML,sanitizeUrl:sanitizeUrl,sanitizeError:sanitizeError,showSafeAlert:showSafeAlert,isInputSafe:isInputSafe});