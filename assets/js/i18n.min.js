if(void 0===window.TranslationSystem){class e{constructor(){this.currentLanguage="vi",this.defaultLanguage="vi",this.translations={},this.supportedLanguages={vi:{name:"Tiáº¿ng Viá»‡t",flag:"ðŸ‡»ðŸ‡³"},en:{name:"English",flag:"ðŸ‡ºðŸ‡¸"},zh:{name:"ä¸­æ–‡",flag:"ðŸ‡¨ðŸ‡³"},ko:{name:"í•œêµ­ì–´",flag:"ðŸ‡°ðŸ‡·"},ja:{name:"æ—¥æœ¬èªž",flag:"ðŸ‡¯ðŸ‡µ"}};try{const e=localStorage.getItem("preferredLanguage");e&&this.supportedLanguages[e]&&(this.currentLanguage=e)}catch(e){}document.body.classList.add("i18n-loading"),this.loadLanguages()}async loadLanguages(){try{await this.loadLanguageFile(this.currentLanguage),this.updateTranslationsFromGlobals(),this.initializeLanguageSelector(),this.translatePage(),document.body.classList.remove("i18n-loading");const e=Object.keys(this.supportedLanguages).filter(e=>e!==this.currentLanguage);await Promise.all(e.map(e=>this.loadLanguageFile(e).catch(()=>{}))),this.updateTranslationsFromGlobals()}catch(e){console.error("Error loading languages:",e),document.body.classList.remove("i18n-loading")}}updateTranslationsFromGlobals(){this.translations={vi:"undefined"!=typeof vietnameseTranslations?vietnameseTranslations:{},en:"undefined"!=typeof englishTranslations?englishTranslations:{},zh:"undefined"!=typeof chineseTranslations?chineseTranslations:{},ko:"undefined"!=typeof koreanTranslations?koreanTranslations:{},ja:"undefined"!=typeof japaneseTranslations?japaneseTranslations:{}}}loadLanguageFile(e){return new Promise((t,a)=>{if(document.querySelector(`script[src*="/languages/${e}.js"]`))return void t();const n=document.createElement("script"),s=document.querySelector('script[src*="i18n.js"]'),o=s?s.src.replace(/\/i18n\.js.*$/,""):"/assets/js";n.src=`${o}/languages/${e}.js`,n.onload=t,n.onerror=a,document.head.appendChild(n)})}initializeLanguageSelector(){const e=document.querySelector(".navbar-nav");if(!e)return;const t=document.createElement("li");t.className="nav-item dropdown",t.innerHTML=`\n            <a class="nav-link dropdown-toggle" href="#" id="languageDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">\n                <i class="fas fa-language"></i> ${this.supportedLanguages[this.currentLanguage].name}\n            </a>\n            <ul class="dropdown-menu" aria-labelledby="languageDropdown">\n                ${Object.entries(this.supportedLanguages).map(([e,t])=>`\n                    <li><a class="dropdown-item ${e===this.currentLanguage?"active":""}" href="#" data-lang="${e}">\n                        ${t.name}\n                    </a></li>\n                `).join("")}\n            </ul>\n        `,e.appendChild(t),t.querySelectorAll(".dropdown-item").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault();const t=e.target.dataset.lang;t&&t!==this.currentLanguage&&this.changeLanguage(t)})})}changeLanguage(e){if(!this.supportedLanguages[e])return;const t=this.currentLanguage;this.currentLanguage=e;try{localStorage.setItem("preferredLanguage",e)}catch(e){}"undefined"!=typeof gtag&&gtag("event","language_change",{event_category:"user_interaction",event_label:`${t}_to_${e}`,previous_language:t,new_language:e});const a=document.getElementById("languageDropdown");a&&(a.innerHTML=`<i class="fas fa-language"></i> ${this.supportedLanguages[e].name}`),document.querySelectorAll(".dropdown-item").forEach(t=>{t.classList.toggle("active",t.dataset.lang===e)}),this.translatePage(),window.dispatchEvent(new CustomEvent("languageChanged",{detail:{language:e}}))}t(e,t=e){const a=this.translations[this.currentLanguage];if(a&&a[e])return a[e];const n=this.translations[this.defaultLanguage];return n&&n[e]?n[e]:t}translatePage(){document.querySelectorAll("[data-i18n]").forEach(e=>{const t=e.getAttribute("data-i18n");if("INPUT"===e.tagName&&("text"===e.type||"number"===e.type)||"TEXTAREA"===e.tagName){e.dataset.i18nPlaceholder||(e.dataset.i18nPlaceholder=e.getAttribute("placeholder")||"");const a=this.t(t,e.dataset.i18nPlaceholder);return void(e.placeholder=a)}e.dataset.i18nDefault||(e.dataset.i18nDefault=e.innerHTML);const a=this.t(t,e.dataset.i18nDefault);e.hasAttribute("data-i18n-html")||a.includes("<strong>")||a.includes("<")?e.innerHTML=a:e.textContent=a});const e=document.querySelector('meta[name="i18n-title"]');e&&(document.title=this.t(e.content)+" - "+this.t("site.title")),this.updateDynamicContent()}updateDynamicContent(){"function"==typeof updateCalendar&&updateCalendar(),"function"==typeof updateClock&&updateClock(),this.updateMonthNames(),this.updateDayNames()}updateMonthNames(){const e=document.getElementById("calendar-title");if(e&&"undefined"!=typeof currentMonth&&"undefined"!=typeof currentYear){const t=this.t(`month.${currentMonth+1}`);e.textContent=`${t} ${currentYear}`}}updateDayNames(){const e=document.querySelector(".calendar-table");if(e){const t=e.querySelector("tr");if(t){const e=["cal.sunday","cal.monday","cal.tuesday","cal.wednesday","cal.thursday","cal.friday","cal.saturday"];t.querySelectorAll("th").forEach((t,a)=>{e[a]&&(t.textContent=this.t(e[a]))})}}}getCurrentLanguage(){return this.currentLanguage}getSupportedLanguages(){return this.supportedLanguages}}window.TranslationSystem=e}document.addEventListener("DOMContentLoaded",()=>{if(!window.translationSystem)try{window.translationSystem=new window.TranslationSystem,window.t=(e,t)=>window.translationSystem.t(e,t)}catch(e){console.error("Failed to initialize TranslationSystem:",e)}}),window.addEventListener("languageChanged",e=>{console.log("Language changed to:",e.detail.language)});