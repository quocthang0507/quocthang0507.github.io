if(void 0===window.TranslationSystem){class e{constructor(){this.currentLanguage="vi",this.translations={},this.supportedLanguages={vi:{name:"Tiáº¿ng Viá»‡t",flag:"ðŸ‡»ðŸ‡³"},en:{name:"English",flag:"ðŸ‡ºðŸ‡¸"},zh:{name:"ä¸­æ–‡",flag:"ðŸ‡¨ðŸ‡³"},ko:{name:"í•œêµ­ì–´",flag:"ðŸ‡°ðŸ‡·"},ja:{name:"æ—¥æœ¬èªž",flag:"ðŸ‡¯ðŸ‡µ"}};try{const e=localStorage.getItem("preferredLanguage");e&&this.supportedLanguages[e]&&(this.currentLanguage=e)}catch(e){}document.body.classList.add("i18n-loading"),this.loadLanguages()}async loadLanguages(){try{await this.loadLanguageFile(this.currentLanguage),this.updateTranslationsFromGlobals(),this.initializeLanguageSelector(),this.translatePage(),document.body.classList.remove("i18n-loading");const e=Object.keys(this.supportedLanguages).filter(e=>e!==this.currentLanguage);await Promise.all(e.map(e=>this.loadLanguageFile(e).catch(()=>{}))),this.updateTranslationsFromGlobals()}catch(e){console.error("Error loading languages:",e),document.body.classList.remove("i18n-loading")}}updateTranslationsFromGlobals(){this.translations={vi:"undefined"!=typeof vietnameseTranslations?vietnameseTranslations:{},en:"undefined"!=typeof englishTranslations?englishTranslations:{},zh:"undefined"!=typeof chineseTranslations?chineseTranslations:{},ko:"undefined"!=typeof koreanTranslations?koreanTranslations:{},ja:"undefined"!=typeof japaneseTranslations?japaneseTranslations:{}}}loadLanguageFile(e){return new Promise((a,t)=>{if(document.querySelector(`script[src*="/languages/${e}.js"]`))return void a();const n=document.createElement("script"),s=document.querySelector('script[src*="i18n.js"]'),o=s?s.src.replace(/\/i18n\.js.*$/,""):"/assets/js";n.src=`${o}/languages/${e}.js`,n.onload=a,n.onerror=t,document.head.appendChild(n)})}initializeLanguageSelector(){const e=document.querySelector(".navbar-nav");if(!e)return;const a=document.createElement("li");a.className="nav-item dropdown",a.innerHTML=`\n            <a class="nav-link dropdown-toggle" href="#" id="languageDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">\n                <i class="fas fa-language"></i> ${this.supportedLanguages[this.currentLanguage].name}\n            </a>\n            <ul class="dropdown-menu" aria-labelledby="languageDropdown">\n                ${Object.entries(this.supportedLanguages).map(([e,a])=>`\n                    <li><a class="dropdown-item ${e===this.currentLanguage?"active":""}" href="#" data-lang="${e}">\n                        ${a.name}\n                    </a></li>\n                `).join("")}\n            </ul>\n        `,e.appendChild(a),a.querySelectorAll(".dropdown-item").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault();const a=e.target.dataset.lang;a&&a!==this.currentLanguage&&this.changeLanguage(a)})})}changeLanguage(e){if(!this.supportedLanguages[e])return;const a=this.currentLanguage;this.currentLanguage=e;try{localStorage.setItem("preferredLanguage",e)}catch(e){}"undefined"!=typeof gtag&&gtag("event","language_change",{event_category:"user_interaction",event_label:`${a}_to_${e}`,previous_language:a,new_language:e});const t=document.getElementById("languageDropdown");t&&(t.innerHTML=`<i class="fas fa-language"></i> ${this.supportedLanguages[e].name}`),document.querySelectorAll(".dropdown-item").forEach(a=>{a.classList.toggle("active",a.dataset.lang===e)}),this.translatePage(),window.dispatchEvent(new CustomEvent("languageChanged",{detail:{language:e}}))}t(e,a=e){const t=this.translations[this.currentLanguage];if(t&&t[e])return t[e];const n=this.translations.vi;return n&&n[e]?n[e]:a}translatePage(){document.querySelectorAll("[data-i18n]").forEach(e=>{const a=e.getAttribute("data-i18n");if("INPUT"===e.tagName&&("text"===e.type||"number"===e.type)||"TEXTAREA"===e.tagName){e.dataset.i18nPlaceholder||(e.dataset.i18nPlaceholder=e.placeholder||"");const t=this.t(a,e.dataset.i18nPlaceholder);return void(e.placeholder=t)}e.dataset.i18nDefault||(e.dataset.i18nDefault=e.innerHTML);const t=this.t(a,e.dataset.i18nDefault);e.hasAttribute("data-i18n-html")||t.includes("<strong>")||t.includes("<")?e.innerHTML=t:e.textContent=t});const e=document.querySelector('meta[name="i18n-title"]');e&&(document.title=this.t(e.content)+" - "+this.t("site.title")),this.updateDynamicContent()}updateDynamicContent(){"function"==typeof updateCalendar&&updateCalendar(),"function"==typeof updateClock&&updateClock(),this.updateMonthNames(),this.updateDayNames()}updateMonthNames(){const e=document.getElementById("calendar-title");if(e&&"undefined"!=typeof currentMonth&&"undefined"!=typeof currentYear){const a=this.t(`month.${currentMonth+1}`);e.textContent=`${a} ${currentYear}`}}updateDayNames(){const e=document.querySelector(".calendar-table");if(e){const a=e.querySelector("tr");if(a){const e=["cal.sunday","cal.monday","cal.tuesday","cal.wednesday","cal.thursday","cal.friday","cal.saturday"];a.querySelectorAll("th").forEach((a,t)=>{e[t]&&(a.textContent=this.t(e[t]))})}}}getCurrentLanguage(){return this.currentLanguage}getSupportedLanguages(){return this.supportedLanguages}}window.TranslationSystem=e}document.addEventListener("DOMContentLoaded",()=>{if(!window.translationSystem)try{window.translationSystem=new window.TranslationSystem,window.t=(e,a)=>window.translationSystem.t(e,a)}catch(e){console.error("Failed to initialize TranslationSystem:",e)}}),window.addEventListener("languageChanged",e=>{console.log("Language changed to:",e.detail.language)});