document.addEventListener("DOMContentLoaded",function(){const t=Math.PI;function n(t,n,e){let o=Math.floor((14-n)/12),a=e+4800-o,r=n+12*o-3;return t+Math.floor((153*r+2)/5)+365*a+Math.floor(a/4)-Math.floor(a/100)+Math.floor(a/400)-32045}function e(n,e){let o=n/1236.85,a=o*o,r=a*o,h=t/180,i=2415020.75933+29.53058868*n+1178e-7*a-155e-9*r;i+=33e-5*Math.sin((166.56+132.87*o-.009173*a)*h);let M,l=359.2242+29.10535608*n-333e-7*a-347e-8*r,u=306.0253+385.81691806*n+.0107306*a+1236e-8*r,f=21.2964+390.67050646*n-.0016528*a-239e-8*r,s=(.1734-393e-6*o)*Math.sin(l*h)+.0021*Math.sin(2*h*l);s=s-.4068*Math.sin(u*h)+.0161*Math.sin(2*h*u),s-=4e-4*Math.sin(3*h*u),s=s+.0104*Math.sin(2*h*f)-.0051*Math.sin(h*(l+u)),s=s-.0074*Math.sin(h*(l-u))+4e-4*Math.sin(h*(2*f+l)),s=s-4e-4*Math.sin(h*(2*f-l))-6e-4*Math.sin(h*(2*f+u)),s=s+.001*Math.sin(h*(2*f-u))+5e-4*Math.sin(h*(2*u+l)),M=o<-11?.001+839e-6*o+2261e-7*a-845e-8*r-81e-9*o*r:265e-6*o-278e-6+262e-6*a;let T=i+s-M;return Math.floor(T+.5+e/24)}function o(n,e){let o=(n-2451545.5-e/24)/36525,a=o*o,r=t/180,h=357.5291+35999.0503*o-1559e-7*a-48e-8*o*a,i=280.46645+36000.76983*o+3032e-7*a,M=(1.9146-.004817*o-14e-6*a)*Math.sin(r*h);M=M+(.019993-101e-6*o)*Math.sin(2*r*h)+29e-5*Math.sin(3*r*h);let l=i+M;return l*=r,l-=2*t*Math.floor(l/(2*t)),Math.floor(l/t*6)}function a(t,a){let r=n(31,12,t)-2415021,h=Math.floor(r/29.530588853),i=e(h,a);return o(i,a)>=9&&(i=e(h-1,a)),i}function r(t,n){let a=Math.floor((t-2415021.076998695)/29.530588853+.5),r=0,h=1,i=o(e(a+h,n),n);do{r=i,h++,i=o(e(a+h,n),n)}while(i!=r&&h<14);return h-1}window.LunarCalendar={solarToLunar:function(t,o,h,i=7){let M=n(t,o,h),l=Math.floor((M-2415021.076998695)/29.530588853),u=e(l+1,i);u>M&&(u=e(l,i));let f,s=a(h,i),T=s;s>=u?(f=h,s=a(h-1,i)):(f=h+1,T=a(h+1,i));let c=M-u+1,d=Math.floor((u-s)/29),m=0,g=d+11;if(T-s>365){let t=r(s,i);d>=t&&(g=d+10,d==t&&(m=1))}return g>12&&(g-=12),g>=11&&d<4&&(f-=1),{day:c,month:g,year:f,isLeap:1==m}},lunarToSolar:function(t,n,o,h=!1,i=7){let M,l;n<11?(M=a(o-1,i),l=a(o,i)):(M=a(o,i),l=a(o+1,i));let u=Math.floor(.5+(M-2415021.076998695)/29.530588853),f=n-11;if(f<0&&(f+=12),l-M>365){let t=r(M,i),e=t-2;if(e<0&&(e+=12),0!=h&&n!=e)return{day:0,month:0,year:0};(0!=h||f>=t)&&(f+=1)}return function(t){let n,e,o;t>2299160?(n=t+32044,e=Math.floor((4*n+3)/146097),o=n-Math.floor(146097*e/4)):(e=0,o=t+32082);let a=Math.floor((4*o+3)/1461),r=o-Math.floor(1461*a/4),h=Math.floor((5*r+2)/153);return{day:r-Math.floor((153*h+2)/5)+1,month:h+3-12*Math.floor(h/10),year:100*e+a-4800+Math.floor(h/10)}}(e(u+f,i)+t-1)},getZodiacAnimal:function(t){return["Tý (Chuột)","Sửu (Trâu)","Dần (Hổ)","Mão (Mèo)","Thìn (Rồng)","Tỵ (Rắn)","Ngọ (Ngựa)","Mùi (Dê)","Thân (Khỉ)","Dậu (Gà)","Tuất (Chó)","Hợi (Heo)"][(t-4)%12]},getCanChi:function(t){return`${["Giáp","Ất","Bính","Đinh","Mậu","Kỷ","Canh","Tân","Nhâm","Quý"][(t-4)%10]} ${["Tý","Sửu","Dần","Mão","Thìn","Tỵ","Ngọ","Mùi","Thân","Dậu","Tuất","Hợi"][(t-4)%12]}`},getLunarMonthName:function(t,n=!1){return`${n?"Nhuận ":""}Tháng ${["","Giêng","Hai","Ba","Tư","Năm","Sáu","Bảy","Tám","Chín","Mười","Mười một","Chạp"][t]}`},isLunarLeapYear:function(t,n=7){let e=a(t,n);return a(t+1,n)-e>365}}});