document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("md-input"),n=document.getElementById("md-preview"),o=document.getElementById("copy-html");if(!e||!n||!o)return;if("undefined"==typeof marked||"undefined"==typeof DOMPurify)return void showAlert("Markdown libraries failed to load.","danger");marked.setOptions({gfm:!0,breaks:!0,headerIds:!1,mangle:!1});let t="",d=null;const r=()=>{const o=e.value||"",d=marked.parse(o),r=DOMPurify.sanitize(d);t=r,n.innerHTML=r,"function"==typeof trackToolUsage&&trackToolUsage("markdown_preview","render")};e.addEventListener("input",()=>{d&&window.clearTimeout(d),d=window.setTimeout(r,80)}),o.addEventListener("click",()=>{copyToClipboard(t),"function"==typeof trackToolUsage&&trackToolUsage("markdown_preview","copy_html")}),e.value=e.value||'# Markdown\n\n- Rendered preview\n- Copy HTML\n\n```js\nconsole.log("Hello");\n```\n',r()});