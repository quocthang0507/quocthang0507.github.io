function parseDatabase(t){return t.map(function(t){var e=new Map;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.set(n,t[n]);return e})}function transactionUtility(t,e){var n=0;return t.forEach(function(t,i){n+=t*(e[i]||0)}),n}function itemsetUtilityInTransaction(t,e,n){for(var i=0,r=0;r<t.length;r++){var a=t[r];i+=(e.get(a)||0)*(n[a]||0)}return i}function itemsetUtility(t,e,n){for(var i=0,r=0;r<e.length;r++){for(var a=e[r],c=!0,o=0;o<t.length;o++)if(!a.has(t[o])){c=!1;break}c&&(i+=itemsetUtilityInTransaction(t,a,n))}return i}function itemsetOccupancyInTransaction(t,e){return t.length/e.size}function itemsetOccupancy(t,e){for(var n=0,i=0,r=0;r<e.length;r++){for(var a=e[r],c=!0,o=0;o<t.length;o++)if(!a.has(t[o])){c=!1;break}c&&(n++,i+=itemsetOccupancyInTransaction(t,a))}return 0===n?0:i/n}function computeTWU(t,e){for(var n={},i=0;i<t.length;i++){var r=t[i],a=transactionUtility(r,e);r.forEach(function(t,e){n[e]=(n[e]||0)+a})}return n}function itemsetTWU(t,e,n){for(var i=0,r=0;r<e.length;r++){for(var a=e[r],c=!0,o=0;o<t.length;o++)if(!a.has(t[o])){c=!1;break}c&&(i+=transactionUtility(a,n))}return i}function huopm(t,e,n,i){var r=parseDatabase(t),a=[],c=computeTWU(r,e);return function t(c,o){for(var s=0;s<o.length;s++){var u=c.concat([o[s]]);if(!(itemsetTWU(u,r,e)<n)){var f=itemsetUtility(u,r,e),l=itemsetOccupancy(u,r);f>=n&&l>=i&&a.push({itemset:u.slice(),utility:f,occupancy:l}),t(u,o.slice(s+1))}}}([],Object.keys(c).filter(function(t){return c[t]>=n}).sort(function(t,e){return c[t]-c[e]})),a}"undefined"!=typeof module&&module.exports&&(module.exports={huopm:huopm,parseDatabase:parseDatabase,transactionUtility:transactionUtility,itemsetUtility:itemsetUtility,itemsetOccupancy:itemsetOccupancy,itemsetOccupancyInTransaction:itemsetOccupancyInTransaction,computeTWU:computeTWU,itemsetTWU:itemsetTWU});